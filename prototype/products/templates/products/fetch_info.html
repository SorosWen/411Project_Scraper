<h1> Product Search Page </h1>

<form action="/products/" method="POST">
    {% csrf_token %}
    <label for="product_name">Please enter a product name: </label>
    <input type="text" id = "product_name" name="product_name" required>

    <button type="submit" value="Submit">Search</button>
</form>

{% if product_name %} 
<body>
    <h1>Top 3 Search Results for {{ product_name }}</h1>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <div id ='updateDiv'></div>
    <p id="demo"></p>
        <script>
      
        // change queryString to whatever search term the user enters
        var queryString = '{{ product_name }}'
    
        var staticURL = 'http://api.serpstack.com/search?access_key=540a75178a80616c693cbade72c360e8&query='+
            queryString + ' price=google&location=newyork&google_domain=google.com'
        
        // get the JSON and loop through the search results and display the first 3
        $.getJSON(staticURL, function(data) {
            console.log(data);
            for (i = 0; i < 3; i++) {
                var k = i + 1;
                newParagraph = document.createElement('p');
                newParagraph.textContent = k.toString() + ". " + data.organic_results[i].title;
                document.getElementById("updateDiv").appendChild(newParagraph);

                newParagraph = document.createElement('p');
                newParagraph.textContent = " " + data.organic_results[i].url;
                document.getElementById("updateDiv").appendChild(newParagraph);
            }
        });
        
        </script>
  
  </body>
{% endif %}
